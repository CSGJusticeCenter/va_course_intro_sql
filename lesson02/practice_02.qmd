---
title: "Lesson 2 Exercise"
engine: knitr
filters:
  - interactive-sql
databases:
  - name: state_doc
    path: "https://raw.githubusercontent.com/CSGJusticeCenter/va_data/main/courses/intro_sql/state_doc.db"  
---

1. You’ve been asked to generate a list of residents whose primary language is not English. Write a query to retrieve their first name, last name, and primary language from the residents table. Sort the results alphabetically by last name. You can refer to the ERD above to review table structure and column names.

![](images/corrections_erd.png)

```{.sql .interactive .state_doc}

```

<details>
<summary>Show the answer</summary>

```{.sql .interactive .state_doc}
SELECT first_name,
       last_name,
       primary_language
FROM residents
WHERE primary_language != 'English'
ORDER BY last_name;
```
</details>

2. A program manager wants to better understand the age at which residents had their first arrest. Generate a report that includes each resident’s ID, first name, last name, and age at first arrest. Sort the results in descending order so the oldest age appears first.

```{.sql .interactive .state_doc}


```

<details>
<summary>Show the answer</summary>


```{.sql .interactive .state_doc}
SELECT resident_id,
       first_name,
       last_name,
       age_at_first_arrest
FROM residents
ORDER BY age_at_first_arrest DESC;
```
</details>

